[INFO]: Seed set to: 42 for Python's built-in random module, NumPy and PyTorch.
[INFO]: PyTorch CUDA seeds set to: 42
[INFO]: PyTorch cuDNN deterministic setting set to True for reproducibility.
[INFO]: PyTorch cuDNN benchmark setting set to False for reproducibility.
[INFO]: Number of Training Images: 17252
[INFO]: Number of Validation Images: 4314
[INFO]: Number of Classes: 297

Model: Resnet50
[INFO]: Number of infeatures:2048
[INFO]: Freezing hidden layers...
[INFO]: Setting Loss Function: CrossEntropyLoss..
[INFO]: Setting Optimizer: Adam..
[INFO]: Setting Scheduler: CustomLRSchedulerModified..

Configuration Settings: {
    "Data_Path": "Datasets/ClothesModified/",
    "Save_To": "models/2024-06-27_23:8/Resnet50",
    "Split_Size": 0.8,
    "Models": [
        "Resnet50",
        "Resnet101",
        "EfficientNetB7"
    ],
    "Fine_Tune": false,
    "Pretrained": true,
    "Num_Epochs": 300,
    "Batch_size": 32,
    "Optimizer": {
        "Name": "Adam",
        "lr": 0.001,
        "weight_decay": 0,
        "momentum": 0.9
    },
    "Loss_Function": "CrossEntropyLoss",
    "label_smoothing": 0.1,
    "Scheduler": {
        "Name": "CustomLRSchedulerModified",
        "step_size": 10,
        "gamma": 0.1,
        "Warmup_Epochs": 150,
        "Stop_LR": 10,
        "Base_LR": 0.001,
        "Final_LR": 1e-05
    },
    "EarlyStopping": {
        "Patience": 20,
        "min_delta": 0,
        "verbose": true
    }
}
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
Resnet50                                      [32, 297]                 --
├─ResNet: 1-1                                 [32, 2048]                --
│    └─Conv2d: 2-1                            [32, 64, 112, 112]        (9,408)
│    └─BatchNorm2d: 2-2                       [32, 64, 112, 112]        (128)
│    └─ReLU: 2-3                              [32, 64, 112, 112]        --
│    └─MaxPool2d: 2-4                         [32, 64, 56, 56]          --
│    └─Sequential: 2-5                        [32, 256, 56, 56]         --
│    │    └─Bottleneck: 3-1                   [32, 256, 56, 56]         (75,008)
│    │    └─Bottleneck: 3-2                   [32, 256, 56, 56]         (70,400)
│    │    └─Bottleneck: 3-3                   [32, 256, 56, 56]         (70,400)
│    └─Sequential: 2-6                        [32, 512, 28, 28]         --
│    │    └─Bottleneck: 3-4                   [32, 512, 28, 28]         (379,392)
│    │    └─Bottleneck: 3-5                   [32, 512, 28, 28]         (280,064)
│    │    └─Bottleneck: 3-6                   [32, 512, 28, 28]         (280,064)
│    │    └─Bottleneck: 3-7                   [32, 512, 28, 28]         (280,064)
│    └─Sequential: 2-7                        [32, 1024, 14, 14]        --
│    │    └─Bottleneck: 3-8                   [32, 1024, 14, 14]        1,512,448
│    │    └─Bottleneck: 3-9                   [32, 1024, 14, 14]        1,117,184
│    │    └─Bottleneck: 3-10                  [32, 1024, 14, 14]        1,117,184
│    │    └─Bottleneck: 3-11                  [32, 1024, 14, 14]        1,117,184
│    │    └─Bottleneck: 3-12                  [32, 1024, 14, 14]        1,117,184
│    │    └─Bottleneck: 3-13                  [32, 1024, 14, 14]        1,117,184
│    └─Sequential: 2-8                        [32, 2048, 7, 7]          --
│    │    └─Bottleneck: 3-14                  [32, 2048, 7, 7]          6,039,552
│    │    └─Bottleneck: 3-15                  [32, 2048, 7, 7]          4,462,592
│    │    └─Bottleneck: 3-16                  [32, 2048, 7, 7]          4,462,592
│    └─AdaptiveAvgPool2d: 2-9                 [32, 2048, 1, 1]          --
│    └─Identity: 2-10                         [32, 2048]                --
├─Sequential: 1-2                             [32, 297]                 --
│    └─Linear: 2-11                           [32, 1024]                2,098,176
│    └─BatchNorm1d: 2-12                      [32, 1024]                2,048
│    └─Linear: 2-13                           [32, 512]                 524,800
│    └─BatchNorm1d: 2-14                      [32, 512]                 1,024
│    └─Linear: 2-15                           [32, 297]                 152,361
│    └─BatchNorm1d: 2-16                      [32, 297]                 594
│    └─Dropout: 2-17                          [32, 297]                 --
===============================================================================================
Total params: 26,287,035
Trainable params: 24,842,107
Non-trainable params: 1,444,928
Total mult-adds (G): 130.88
===============================================================================================
Input size (MB): 19.27
Forward/backward pass size (MB): 5691.30
Params size (MB): 105.15
Estimated Total Size (MB): 5815.71
===============================================================================================

Classifier_layer: Sequential(
  (0): Linear(in_features=2048, out_features=1024, bias=True)
  (1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): Linear(in_features=1024, out_features=512, bias=True)
  (3): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (4): Linear(in_features=512, out_features=297, bias=True)
  (5): BatchNorm1d(297, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (6): Dropout(p=0.3, inplace=True)
)

TRAINING COMPLETE IN 204m 57s
Best Validation Acc: 76.193788%

--------------------------------------------------------------------------------

Evaluation...

Validation...
[INFO] Validation Loss: 2.1103 | Acc: 75.8229% | Weighted F1: 75.5169
Accuracy on Validation set using accuracy_score from sklearn: 75.82290217895225%
